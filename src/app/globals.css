@tailwind base;
@tailwind components;
@tailwind utilities;

/* FAQ Accordion Animation */
@keyframes fadeInDown {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Hero Headline Animations */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes gradientX {
  0%, 100% {
    background-size: 200% 200%;
    background-position: left center;
  }
  50% {
    background-size: 200% 200%;
    background-position: right center;
  }
}

@keyframes expand {
  from {
    transform: scaleX(0);
    opacity: 0;
  }
  to {
    transform: scaleX(1);
    opacity: 0.3;
  }
}

@keyframes bounce-slow {
  0%, 100% {
    transform: translateY(0);
    animation-timing-function: cubic-bezier(0.8, 0, 1, 1);
  }
  50% {
    transform: translateY(-10px);
    animation-timing-function: cubic-bezier(0, 0, 0.2, 1);
  }
}

@layer base {
  html {
    scroll-behavior: smooth;
  }

  body {
    font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    line-height: 1.6;
    color: #1C1C1C;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
    font-display: optional;
  }

  /* Only apply overflow-x hidden on mobile to prevent horizontal scroll */
  @media (max-width: 768px) {
    html, body {
      overflow-x: hidden;
    }
  }

  /* Simple overflow prevention */
  *, *::before, *::after {
    box-sizing: border-box;
  }
  
  /* Apply max-width to media elements to prevent overflow */
  img, video, iframe, object, embed, canvas {
    max-width: 100%;
    height: auto;
  }
  
  /* Prevent layout shifts for images */
  img {
    aspect-ratio: attr(width) / attr(height);
  }


  *:focus-visible {
    outline: 2px solid #0D79E5;
    outline-offset: 2px;
    border-radius: 4px;
  }

  .text-ray-darkGray {
    color: #4a5568;
  }

  @media (prefers-contrast: high) {
    .btn-primary {
      border: 2px solid currentColor;
    }
    .btn-secondary {
      border: 3px solid currentColor;
    }
  }

  @media (prefers-reduced-motion: reduce) {
    * {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }

  @media (hover: hover) and (pointer: fine) {
    .dropdown-hover:hover .dropdown-menu {
      display: block;
    }
  }

  @media (hover: none), (pointer: coarse) {
    .dropdown-hover:hover .dropdown-menu {
      display: none;
    }
  }
}

@layer components {
  .content-visibility-auto {
    content-visibility: auto;
    contain-intrinsic-size: 0 500px;
  }

  .btn-primary {
    @apply bg-ray-blue text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-600 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-ray-blue focus:ring-offset-2 shadow-md;
  }

  .btn-secondary {
    @apply bg-white text-ray-blue border-2 border-ray-blue px-6 py-3 rounded-lg font-semibold hover:bg-ray-blue hover:text-white transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-ray-blue focus:ring-offset-2 shadow-md;
  }

  .btn-ghost {
    @apply text-ray-blue px-6 py-3 rounded-lg font-semibold hover:bg-ray-blue hover:text-white transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-ray-blue focus:ring-offset-2;
  }

  .btn-dark {
    @apply bg-ray-dark-900 text-white px-6 py-3 rounded-lg font-semibold hover:bg-ray-dark-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-ray-dark-500 focus:ring-offset-2 shadow-md;
  }

  .test-gradient {
    @apply bg-ray-gradient;
  }

  .shadow-3xl {
    box-shadow: 0 35px 60px -12px rgba(0, 0, 0, 0.25);
  }

  /* --------------------------------------------------
     Spanish overrides for RAY Lead-Magnet Widget
     -------------------------------------------------- */
  /* If <html lang="es"> is present or pathname ends with /es, we assume Spanish homepage */
  html[lang="es"] #ray-widget,
  body.pathname-es #ray-widget {
    /* Example: ensure Spanish placeholder size remains consistent */
  }

  html[lang="es"] #ray-widget button {
    font-size: 0.80rem !important; /* Slightly smaller (~12.8px) to offset longer text */
    padding-left: 12px !important;
    padding-right: 12px !important;
  }

  /* Mobile: hide text so arrow icon appears (match English behavior) */
  @media (max-width: 600px) {
    html[lang="es"] #ray-widget button {
      font-size: 0 !important;
      padding-left: 0 !important;
      padding-right: 0 !important;
    }
  }
}

/* --------------------------------------------------
   Custom overrides for the RAY lead-magnet widget
   -------------------------------------------------- */
#ray-widget {
  /* Allow the widget container to grow */
  min-height: 120px !important; /* further reduce overall height */
  height: 120px !important;
  /* Subtle light-gray border around the widget */
  border: 1px solid rgba(229, 231, 235, 0.6) !important; /* lighter gray, ~40% transparent */
  /* Slightly darker shadow for more depth */
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.10), 14px 18px 34px rgba(0, 0, 0, 0.18) !important;
  /* Prevent layout shift by reserving space */
  contain: layout style; /* Remove paint to allow dropdown to overflow */
}

/* Override height for mobile specifically */
@media (max-width: 640px) {
  #ray-widget {
    min-height: 68px !important;
    height: 68px !important;
  }
  
  /* Also reduce internal elements height for mobile */
  #ray-widget * {
    min-height: 1.5rem !important; /* Reduce from 2rem to 1.5rem (24px) */
  }
}

/* Restore original border-radius for desktop */
@media (min-width: 641px) {
  #ray-widget {
    border-radius: 1.25rem !important; /* 20px - original desktop value */
  }
}

#ray-widget * {
  /* Ensure enough vertical space for two-line placeholder text */
  min-height: 2rem !important; /* 32px */
  line-height: 1.25rem !important; /* Prevent clipping inside inputs */
}

/* Tweak the text-input element (tag name may vary between versions) */
#ray-widget input[type="text"],
#ray-widget input[type="search"] {
  padding-top: 0.625rem !important;  /* 10px */
  padding-bottom: 0.625rem !important;
  height: auto !important;          /* Allow the field to grow with its content */
}

/* Fine-tune the call-to-action button inside the widget */
#ray-widget button {
  padding-top: 0.5rem !important;   /* 8px */
  padding-bottom: 0.5rem !important;
  min-height: 2rem !important;   /* 32px – keeps it clickable while slimmer */
  height: auto !important;
}

/* Make text elements smaller, but keep button text normal */
#ray-widget p,
#ray-widget span:not(button span),
#ray-widget div:not(button div),
#ray-widget input::placeholder {
  font-size: 0.85rem !important;  /* ~13.6px, smaller than default */
  line-height: 1.2 !important;
}

/* Ensure button text stays normal size */
#ray-widget button,
#ray-widget button span,
#ray-widget button div {
  font-size: 0.95rem !important;  /* Keep button text readable */
}

/* Make the "Compare yourself with your local competition" text smaller */
#ray-widget [class*="subtitle"],
#ray-widget [class*="description"],
#ray-widget [class*="tagline"],
#ray-widget .subtitle,
#ray-widget .description,
#ray-widget .tagline {
  font-size: 0.7rem !important;  /* ~11.2px, smaller for subtitle text */
}

/* --------------------------------------------------
   Further reductions for specific widget elements
   -------------------------------------------------- */
#ray-widget button,
#ray-widget button span,
#ray-widget button div {
  font-size: 0.80rem !important; /* Slightly smaller – approx 12.8px */
}

#ray-widget h2.ray-widget-title {
  font-size: 0.90rem !important; /* Reduce dynamic title size */
  line-height: 1.1 !important;
}

/* Reduce button height & horizontal padding */
#ray-widget button {
  padding: 0.35rem 0.75rem !important; /* 6px top/bottom, 12px left/right */
  min-height: 1.75rem !important;      /* ~28px */
}

/* Increase space above the input/button container */
#ray-widget .ray-widget-input-container {
  margin-top: 0.5rem !important;  /* 8px gap above */
}

/* --------------------------------------------------
   Mobile-only fixes for the Hero RAY widget
   -------------------------------------------------- */
@media (max-width: 640px) {
  /* Default state: widget container at bottom of viewport */
  #widget-container {
    position: fixed !important;
    bottom: 1rem !important;
    left: 50% !important;
    transform: translateX(-50%) !important;
    z-index: 50 !important;
    width: min(98vw, 32rem) !important; /* 98% of viewport, higher cap */
    max-width: 32rem !important;        /* ≈512 px, more horizontal space */
    transition: all 0.3s ease-in-out !important;
  }

  /* Core container tweaks */
  #ray-widget {
    min-height: 68px !important;
    padding: 1rem 0.75rem 1rem 0.75rem !important;
    border: none !important;
    box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08), 12px 16px 32px rgba(0, 0, 0, 0.12) !important;
    border-radius: 0.75rem !important; /* 12 px - reduced for mobile */
  }

  /* Hide the animated header to keep things compact */
  #ray-widget .ray-widget-header {
    display: none !important;
  }

  /* Input / button row should stay on a single compact line */
  #ray-widget .ray-widget-input-container {
    margin-top: 0 !important;
    flex-direction: row !important;
    gap: 6px !important;
    align-items: center !important;
  }

  /* Input text tweaks */
  #ray-widget input[type="text"],
  #ray-widget input[type="search"] {
    font-size: 1rem !important;            /* 16 px - prevents mobile zoom */
    padding: 0.5rem 0.75rem 0.5rem 0.25rem !important;
    line-height: 1rem !important;
    height: 40px !important;
  }

  #ray-widget input::placeholder {
    font-size: 1rem !important;            /* 16 px - matches input font-size */
  }

  /* Circle arrow button */
  #ray-widget button {
    width: 40px !important;
    height: 40px !important;
    padding: 0 !important;
    border-radius: 50% !important;
    font-size: 0 !important; /* hide text, we just keep the icon */
  }
  #ray-widget .ray-widget-button-arrow {
    font-size: 18px !important;
  }
}

/* Simple mobile overflow prevention */
@media (max-width: 640px) {
  /* Ensure RAY widget stays within bounds and is perfectly centered */
  #ray-widget {
    max-width: calc(100vw - 0.75rem) !important; /* Reduce margins for more width */
  }
  
  /* Handle scaled image overflow */
  .scale-\[1\.90\] {
    transform: scale(1.6) !important;
    transform-origin: center !important;
  }
  
  /* Extra protection for Hero section */
  .relative.flex.justify-center.lg\:justify-end {
    overflow-x: visible !important;
  }

  /* --------------------------------------------------
     Mobile Sticky Widget Behavior
     -------------------------------------------------- */
  
  /* Override: Widget container fixed within hero bounds when scrolled */
  #widget-container.widget-absolute-hero {
    position: absolute !important;
    bottom: -4rem !important; /* Compensate for hero pb-4 + get to actual base */
    left: 50% !important;
    transform: translateX(-50%) !important;
    z-index: 10 !important;
    width: min(96vw, 40rem) !important;
    max-width: 40rem !important;
    transition: all 0.3s ease-in-out !important;
    
    /* Override any conflicting styles */
    top: auto !important;
    margin-bottom: 0 !important;
    padding-bottom: 0 !important;
  }
  
  /* Ensure hero-container is positioned relative for absolute positioning context */
  .hero-container {
    position: relative !important;
  }
}
